<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>
    
      Felix Krause
    
  </title>
  
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="alternate" type="application/rss+xml" title="Felix Krause" href="/feed.xml">
  
    <script>
  // Google Analytics
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-18658848-6', 'auto');
  ga('set', 'anonymizeIp', true)
  ga('send', 'pageview');
</script>

  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    <a class="site-title" href="/">Felix Krause</a>
  
    <nav class="site-nav">
      <input type="checkbox" id="nav-trigger" class="nav-trigger" />
      <label for="nav-trigger">
        <span class="menu-icon">
          <svg viewBox="0 0 18 15" width="18px" height="15px">
            <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
            <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
            <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
          </svg>
        </span>
      </label>

      <div class="trigger">
        <a href="/" class="page-link active">Blog</a>
        <a href="/privacy" class="page-link ">Privacy</a>
        <a href="/projects" class="page-link ">Projects</a>
        <a href="/archive" class="page-link ">Archive</a>
        <a href="/about" class="page-link ">About</a>
      </div>
    </nav>
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div id="sidebar">
  <h1 style="font-size: 21px;">Felix Krause</h1>
  <p>Founder of <a href="https://fastlane.tools" target="_blank">fastlane.tools</a></p>

  
<div id="story-available">
  <img 
    src="https://graph.facebook.com/100000723486971/picture?type=large"
    id="storyProfilePicture"
    onclick="showStories()"
  />
</div>

<div id="storyViewer">
  <div id="storyViewerDimmedBackground" onclick="dismissStories()"></div>
  <div id="storyContent">
    <div id="storyHeader">
      <img 
        id="storyHeaderProfilePicture"
        onclick="window.open('https://instagram.com/krausefx', '_blank')"
      />
      <p id="storyUserlink"><a href="https://instagram.com/krausefx" target="_blank">KrauseFx</a></p>
      <p id="storyTimestamp"></p>
      <p id="poweredByInstapipe"><a href="https://instapipe.net" target="_blank">instapipe.net</a></p>
    </div>
    <div id="storyProgressBar"></div>
    <div id="storyBackButton" class="storyButton" onclick="userDidClickPreviousStory()">
      <
    </div>
    <div id="storyNextButton" class="storyButton" onclick="userDidClickNextStory()">
      >
    </div>

    <video autoplay playsinline muted id="storyVideoViewer">
    </video>
    <div id="storyPhotoViewer" onclick="userDidClickNextStory()">
    </div>
  </div>
  <img src="" id="fakeContentToPreloadImages" />
</div>

<script type='text/javascript'>
let host = "https://instapipe.herokuapp.com/"
let userId = "4409072"

var storiesToShow = null;
var timeOutForPhotos = 4.0;
var storyProgressSpacing = 5;
var progressPadding = 2;
var progressBars = null;
var storiesContent = null;

var nextStoryTimeout = null;
var currentIndex = -1;

function preloadStoriesIndex() {
  var url = host + "stories.json?user_id=" + userId;

  var xmlHttp = new XMLHttpRequest();
  xmlHttp.onreadystatechange = function() { 
    if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
      storiesContent = JSON.parse(xmlHttp.responseText)
      if (storiesContent.length == 0) {
        // Default it's shown, as it looks nicer
        // and I post stories most days :joy:
        document.getElementById("story-available").className += "story-not-available"
      } else {
        // preload the first story if it's a picture
        if (!storiesContent[0]["is_video"]) {
          document.getElementById("fakeContentToPreloadImages").src = storiesContent[0]["signed_url"]
        }
      }
    }
  };

  xmlHttp.open("GET", url, true); // true = asynchronous 
  xmlHttp.send(null);
}

function showStories() {
  if (storiesContent == null || storiesContent.length == 0) {
    return;
  }

  // Copy the profile picture URL to the story header, to only have to define it once
  // we only do that once everything is loaded, as depending on the website
  // the image node might not be acccessible yet
  let profileImageURL = document.getElementById("storyProfilePicture").src
  document.getElementById("storyHeaderProfilePicture").src = profileImageURL;

  storiesToShow = []
  progressBars = []

  document.getElementById("storyViewer").style.display = "block"

  for (let storyIndex in storiesContent) {
    let currentStory = storiesContent[storyIndex]
    storiesToShow.push(currentStory)
  }

  for (let currentStoryIndex in storiesToShow) {
    let currentStory = storiesToShow[currentStoryIndex]

    // Append the progress items
    var progressBarBackground = document.createElement("div")
    progressBarBackground.className = "storyProgressBarItemBg"
    progressBarBackground.style.width = "calc(" + (1.0 / storiesToShow.length) * 100 + "%" + " - " + progressPadding * 2 + "px)"
    progressBarBackground.style.marginRight = progressPadding + "px"
    progressBarBackground.style.marginLeft = progressPadding + "px"
    document.getElementById("storyProgressBar").appendChild(progressBarBackground)

    var progressBarForeground = document.createElement("div")
    progressBarForeground.style.width = "0%"
    progressBarForeground.className = "storyProgressBarItemFg"
    progressBarBackground.appendChild(progressBarForeground)

    progressBars.push(progressBarForeground)
  }

  currentIndex = 0
  renderCurrentStory()

  var xmlHttp = new XMLHttpRequest();
  xmlHttp.onreadystatechange = function() {}
  xmlHttp.open("GET", host + "didOpenStories", true); // true = asynchronous 
  xmlHttp.send(null);
}

function renderCurrentStory() {
  currentStory = storiesToShow[currentIndex]
  
  for (let index in progressBars) {
    let currentProgressBar = progressBars[index]
    if (currentIndex > index) {
      currentProgressBar.style.width = "100%"
    } else {
      currentProgressBar.style.width = "0%"
    }
  }

  // Show image/video
  let videoViewer = document.getElementById("storyVideoViewer")
  let photoViewer = document.getElementById("storyPhotoViewer")
  let progressBarContent = progressBars[currentIndex]

  document.getElementById("storyTimestamp").textContent = currentStory["formatted_time_diff"]

  if (currentStory["is_video"]) {
    videoViewer.src = currentStory["signed_url"]
    videoViewer.style.display = "block"
    videoViewer.onended = function() {
      if (currentIndex < storiesToShow.length - 1) {
        currentIndex++;
        renderCurrentStory();
      } else {
        dismissStories();
      }
    };
    let videoUpdatedDuration = function() {
      // this is triggered when the video file was loaded
      // videos have dynamic length
      animateProgressBar(progressBarContent, videoViewer.duration)
      videoViewer.removeEventListener("durationchange", videoUpdatedDuration)
    }
    videoViewer.addEventListener("durationchange", videoUpdatedDuration)
    videoViewer.load()
    videoViewer.play()
    photoViewer.style.display = "none"
  } else {
    photoViewer.style.backgroundImage = "url('" + currentStory["signed_url"] + "')"
    videoViewer.style.display = "none"
    photoViewer.style.display = "block"
    animateProgressBar(progressBarContent, timeOutForPhotos) // photos are always x seconds

    // Advance to next story after X seconds
    nextStoryTimeout = setTimeout(function() {
      if (currentIndex < storiesToShow.length - 1) {
        currentIndex++;
        renderCurrentStory();
      } else {
        dismissStories();
      }
    }, timeOutForPhotos * 1000)
  }

  // Trigger the next one
  if (currentIndex < storiesToShow.length - 1 && !storiesToShow[currentIndex + 1]["is_video"])
  {
    setTimeout(function() {
      // Poor person's pre-loading of images, with a slight delay
      document.getElementById("fakeContentToPreloadImages").src = storiesToShow[currentIndex + 1]["signed_url"]
    }, timeOutForPhotos / 3.0 * 1000)
  }
}

function animateProgressBar(progressBar, duration) {
  progressBar.style.animationName = "storyViewProgress";
  progressBar.style.animationDuration = duration + "s";
}

function userDidClickPreviousStory() {
  if (currentIndex > 0) {
    stopAllAnimations()
    currentIndex--;
    renderCurrentStory();
  } else {
    dismissStories();
  }
}

function userDidClickNextStory() {
  if (currentIndex < storiesToShow.length - 1) {
    stopAllAnimations()
    currentIndex++;
    renderCurrentStory();
  } else {
    dismissStories();
  }
}

function stopAllAnimations() {
  clearTimeout(nextStoryTimeout)
  document.getElementById("storyVideoViewer").onended = null

  for (let index in progressBars) {
    let currentProgressBar = progressBars[index]
    currentProgressBar.style.animationName = null
  }
}

function dismissStories() {
  document.getElementById("storyViewer").style.display = "none"
  document.getElementById("storyProgressBar").innerHTML = ""
  stopAllAnimations()
}

window.addEventListener("keyup", function(e) {
  if (e.keyCode == 27) { // ESC
    dismissStories()
    return true;
  }
  if (e.keyCode == 37) { // Left
    userDidClickPreviousStory();
  }
  if (e.keyCode == 39) { // Right
    userDidClickNextStory();
  }
}, false);

preloadStoriesIndex();

</script>
<style type='text/css'>
#storyProfilePicture {
  width: 128px;
  height: 128px;
  border-radius: 70px;
  margin-left: 3px;
  margin-top: 3px;
  cursor: pointer;
  border: 4px solid white;
}

#story-available {
  background-image: linear-gradient(rgb(186, 62, 138), #fba051);
  height: 142px;
  width: 142px;
  z-index: -10;
  border-radius: 70px;
  margin-bottom: 15px;
}

#story-available.story-not-available {
  background-image: none !important;
}

#storyViewer {
  height: 100%;
  width: 100%;
  position: fixed;
  top: 0;
  left: 0;
  z-index: 100;
  text-align: center;
  display: none;

  font-family: 'Helvetica Neue', sans-serif;
  font-weight: normal;
}
#storyViewer > #storyViewerDimmedBackground {
  /* This is a separate div to allow onclick events */
  background-color: rgba(0, 0, 0, 0.8);
  height: 100%;
  width: 100%;
  z-index: -1;
  position: absolute;
}

#storyViewer p {
  color: #686868;
  font-size: 20px;
  line-height: 24px;
  margin: 0 0 24px;
  text-align: center;
  text-justify: inter-word;
}

#storyViewer > #storyContent {
  width: 512px;
  max-width: 80%; /* for mobile devices */
  margin-top: 30px;
  display: inline-block;

  /* 
    To get the right aspect ratio, while still having a dynamic content size
    https://stackoverflow.com/questions/1495407/maintain-the-aspect-ratio-of-a-div-with-css
    IG content: 910px height to 512px width = ~178%
    So the `padding-bottom` sets the height of the content
  */
  padding-bottom: 178%;
}

#storyViewer > #storyContent > .storyButton {
  position: fixed;
  top: calc(910px - 450px);
  background-color: rgba(200, 200, 200, 0.88);
  padding: 10px;
  color: rgba(0, 0, 0, 0.8);
  font-weight: bolder;
  font-size: 16px;
  border-radius: 18px;
  width: 20px;
  height: 20px;
  text-align: center;
  cursor: pointer;
}

#storyViewer > #storyContent > #storyBackButton {
  left: 50px;
}

#storyViewer > #storyContent > #storyNextButton {
  right: 53px; /* no idea where the difference comes from */
}

#storyViewer > #storyContent > #storyPhotoViewer {
  width: 100%;
  padding-bottom: 178%; /* see comment in #storyContent */
  background-size: cover;
  background-repeat: no-repeat;
  background-position: 50% 50%;
}

#storyViewer > #storyContent > #storyVideoViewer {
  padding-bottom: 178%; /* see comment in #storyContent */
  width: 100%;
}

#storyViewer > #storyContent > #storyProgressBar {
  width: calc(100% + 4px);
  margin-left: -2px;
  height: 3px;
  margin-top: 10px;
  margin-bottom: 10px;
}

#storyViewer > #storyContent > #storyProgressBar > .storyProgressBarItemBg {
  border-radius: 6px;
  background-color: rgba(187, 187, 187, 0.6);
  height: 100%;
  display: inline-block;
  float: left;
}

.storyProgressBarItemFg {
  background-color: #FFF;
  height: 100%;
  border-radius: 3px;
  animation-timing-function: linear;
}

#fakeContentToPreloadImages {
  height: 0;
  width: 0;
  opacity: 0;
}

@keyframes storyViewProgress {
  from { width: 0%; }
  to { width: 100%; }
}

/* Story header */
#storyHeader {
  height: 50px;
  text-align: left;
}

#storyHeader > #storyHeaderProfilePicture {
  height: 38px;
  width: 38px;
  border-radius: 19px;
  cursor: pointer;
  margin-top: 7px;
  display: block-inline;
}

#storyHeader > #storyUserlink {
  display: block-inline;
  margin-left: 50px;
  text-align: left;
  margin-top: -40px; /* hacky */
  padding-top: 0;
  font-size: 20px;
}

#storyHeader > #storyUserlink > a {
  color: white !important;
  text-decoration: none;
}

#storyHeader > #storyTimestamp {
  color: #777;
  display: block-inline;
  margin-left: 50px;
  text-align: left;
  margin-top: -28px;
  padding-top: 0;
  font-size: 16px;
}

#storyHeader > #poweredByInstapipe {
  display: block-inline;
  margin-left: 150px;
  text-align: right;
  margin-top: -50px; /* hacky */
  padding-top: 0;
  font-size: 16px;
}

#storyHeader > #poweredByInstapipe > a {
  color: #999 !important;
  text-decoration: none;
}

</style>

  <p><a href="/about">More about me</a></p>

  <!-- Social links -->
  <ul class="social-media-list" style="margin-top: 20px; margin-bottom: 30px;">
    <li>
      <a href="https://github.com/KrauseFx" target="_blank"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">KrauseFx</span></a>

    </li>
    <li>
      <a href="https://twitter.com/KrauseFx" target="_blank"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">KrauseFx</span></a>

    </li>
    <li>
      <a href="https://instagram.com/KrauseFx" target="_blank"><span class="icon icon--instagram"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
</span><span class="username">KrauseFx</span></a>

    </li>
    <li>
      <a href="https://www.linkedin.com/in/KrauseFx"><span class="icon icon--linked"><svg width="16px" height="16px" viewBox="0 0 430.117 430.117" xml:space="preserve"><path id="LinkedIn" fill="#828282" d="M430.117,261.543V420.56h-92.188V272.193c0-37.271-13.334-62.707-46.703-62.707 c-25.473,0-40.632,17.142-47.301,33.724c-2.432,5.928-3.058,14.179-3.058,22.477V420.56h-92.219c0,0,1.242-251.285,0-277.32h92.21 v39.309c-0.187,0.294-0.43,0.611-0.606,0.896h0.606v-0.896c12.251-18.869,34.13-45.824,83.102-45.824 C384.633,136.724,430.117,176.361,430.117,261.543z M52.183,9.558C20.635,9.558,0,30.251,0,57.463 c0,26.619,20.038,47.94,50.959,47.94h0.616c32.159,0,52.159-21.317,52.159-47.94C103.128,30.251,83.734,9.558,52.183,9.558z M5.477,420.56h92.184v-277.32H5.477V420.56z"/></svg>
</span><span class="username">KrauseFx</span></a>

    </li>
  </ul>

  <hr />

  <a href="https://whereisfelix.today" target="_blank">
    ✈️ WhereIsFelix.today
  </a>

  <hr />

  <p class="subscribe-newsletter">
  Want to be the first to hear about more privacy and mobile related essays?
</p>

<form class="subscribe-form" action="https://krausefx.us10.list-manage.com/subscribe/post?u=a84ca3495977afb89bf2b98fb&amp;id=d9610c8987" method="post" target="popupwindow" onsubmit="window.open('https://krausefx.us10.list-manage.com/subscribe/post?u=a84ca3495977afb89bf2b98fb', 'popupwindow', 'scrollbars=yes,width=600,height=620');return true">
  <label for="tlemail"></label>
  <input type="text" placeholder="Email Address" name="EMAIL" id="tlemail">
  <input type="hidden" value="1" name="embed">
  <button type="submit" name="subscribe">
    Subscribe
  </button>
</form>


  <hr />

  <div class='jekyll-twitter-plugin'><a class="twitter-timeline" data-width="500" data-tweet-limit="5" href="https://twitter.com/KrauseFx?ref_src=twsrc%5Etfw">Tweets by KrauseFx</a>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>

</div>


        <div class="home">
  
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline"><a href="/blog/how-i-use-twitter">How I use Twitter</a></h1>
        <p class="post-meta">
          <time datetime="2018-03-06T00:00:00+00:00" itemprop="datePublished">
            
            Mar 6, 2018
          </time>
          </p>
      </header>

      <div class="post-content" itemprop="articleBody">
        <h2 id="background">Background</h2>

<p>For most people, using the official Twitter client works fine. It’s optimized to show you new content you might be interested in, makes it easy to follow new users, and shows content that might be most relevant to you first. If you have an engineering mindset, chances are you want to be in control of what you see in your timeline.</p>

<p>I use Twitter to stay up to date with certain people. I want to hear about new projects or new content they published, new blog posts, thoughts of them, etc. I’m not interested in hearing political opinions, sport scores, etc, which I already have Facebook for. If I follow someone, I’ll read every single tweet from them. For the last 5 years, I didn’t miss a tweet in my timeline, so I have to be very careful about who to follow, and what content to see. So I set out to customize Twitter to achieve that goal, and to only see about 50-75 tweets per day.</p>

<h2 id="solution">Solution</h2>

<p>I’ve been using <a href="https://tapbots.com/tweetbot/">Tweetbot</a> for the last few years, the technique described below might work with other third party Twitter clients also.</p>

<h3 id="muted-keywords">Muted Keywords</h3>

<p>Very basic list of words, that as soon as a tweet contains one of them, it will be hidden, examples include:</p>

<ul>
  <li>headphone jack</li>
  <li>drake</li>
  <li>podcast</li>
  <li>president</li>
</ul>

<h3 id="muted-users">Muted users</h3>

<p>I stopped using this feature, now that I use secret lists to follow people (see below), and disabled RTs. Muting users for a given time period or forever is useful for a few situations:</p>

<ul>
  <li>Some users in your timeline might promote a product, so you can mute that product</li>
  <li>If a user is at a conference/event you’re not interested in, you can mute them for a few days</li>
</ul>

<h3 id="muted-regexes">Muted Regexes</h3>

<p>A very powerful feature of Tweetbot is to define a regex to hide tweet. I use it to hide annoying jokes like</p>

<ul>
  <li><code class="highlighter-rouge">remember \w+</code></li>
  <li><code class="highlighter-rouge">german word for \w+</code></li>
  <li><code class="highlighter-rouge">\w+ is the new \w+</code></li>
</ul>

<p>or to hide tweets from people that think we’re interested about their airplane delays or #sports</p>

<ul>
  <li><code class="highlighter-rouge">(virgin|Virgin|@United|delta|Delta|JetBlue|jetblue)</code></li>
  <li>twitter.com/i/moments</li>
  <li>For every #sports #event there are also custom-made mute filters (truncated): <code class="highlighter-rouge">(?#World Cup)(?i)((?# Terms)(Brazil\s*2014|FIFA|World\s*Cup|Soccer|F(oo|u)tbal)|(?# Chants)(go a l |[^\w](ole\s*){2,})|(?# Teams)(#(B....</code></li>
</ul>

<h3 id="hide-all-mentions">Hide all mentions</h3>

<p>This very much changed my whole timeline (for the better). Turns out, I follow people for their announcements, what they work on, what they’re doing, what they’re thinking about, etc. I actually don’t want to see 2 people communicating publicly using @ mentions, unless it’s a topic I’m interested in. So I started hiding all tweets that start with an <code class="highlighter-rouge">@</code> symbol using a simple Tweetbot regex</p>

<ul>
  <li><code class="highlighter-rouge">^@</code></li>
</ul>

<p>If I want to see responses to a tweet, I’d swipe to the left side, and see all replies.</p>

<h3 id="muted-clients">Muted Clients</h3>

<p>Muting certain clients has been amazing, very easy to set up and cleans up your timeline a lot. Some of the clients I mute:</p>

<ul>
  <li>Buffer (to avoid “content marketing”, so many companies make the mistake of tweeting the same posts every week or so using Buffer)</li>
  <li>IFTTT (lots of people use that to auto-post not original content)</li>
  <li>Spotify</li>
  <li>Foursquare (I follow friends on Swarm already, no need to see it twice)</li>
  <li>Facebook</li>
</ul>

<p><img src="/assets/posts/tweetbot_filters.png" width="220" style="float: right; margin-left: 20px" /></p>

<h3 id="secret-lists">Secret Lists</h3>

<p>One issue I had was to balance the number of tweets in my timeline, and then also being polite and following friends. To avoid the whole “Why are you not following me?” conversation, I now use a private list to follow about 300 people only. I <a href="https://github.com/krausefx/twitter-unfollow">open sourced the script</a> I used to migrate all the people I used to follow over to a private list.</p>

<h3 id="disable-rts">Disable RTs</h3>

<p>This has been a great change: As described above, I follow people for what they do, what they think of, and what they’re working on. Some people have the habit of RTing content that might be interesting, but not relevant to why I want to stay subscribed to their tweets. On Tweetbot, you can.</p>

<h3 id="muting-hashtags">Muting hashtags</h3>

<p><img src="/assets/posts/tweetbot_filters_2.png" width="220" style="float: right; margin-left: 20px; margin-top: 20px" /></p>

<p>I thank everyone for using hashtags for certain events, making it easy to hide them from my timeline :)</p>

<h3 id="disadvantages-of-this-approach">Disadvantages of this approach</h3>

<p>Some of the newer Twitter features don’t have an API, and therefore can’t be offered by Tweetbot. This includes Polls, Moments and Group DMs. Since I don’t want to miss group DMs, I set up email notifications for Twitter DMs, and set up a Gmail filter to auto-archive emails that are not from group DMs.</p>

<h3 id="summary">Summary</h3>

<p>I’ve spent quite some time optimizing that workflow, and it’s very specific, and probably not useful for most people. I try to minimize my time on social media, I only browse my Twitter feed when I have a few minutes to kill on the go. Meaning I work through my timeline only on my iPhone, and reply to mentions and DMs only on my Mac. I don’t want to come across uninterested, I do follow people on Facebook, I do read news and stay up to date. Twitter is a place for very specific content for me, and I want to keep using it as that.</p>


        <!-- <p style="margin-top: 30px" class="side-projects-note">
  <small>Unless otherwise mentioned in the post, those projects are side projects which I work on on weekends and evenings, and are not affiliated with my work or employer.</small>
</p>
 -->
      </div>

      <p class="extra-info">
        
          Tags: twitter &nbsp; | &nbsp; 
        
        <a href="https://github.com/KrauseFx/krausefx.com/edit/master/_posts/2018-03-06-how-i-use-twitter.md" target="_blank" class="forkButton">
  <svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
 
  Edit on GitHub
</a>
      </p>
    </article>
  
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline"><a href="/blog/follow-user">iOS Privacy: Track website activities, steal user data &amp; credentials and add your own ads to any website in your iOS app</a></h1>
        <p class="post-meta">
          <time datetime="2018-03-03T00:00:00+00:00" itemprop="datePublished">
            
            Mar 3, 2018
          </time>
          </p>
      </header>

      <div class="post-content" itemprop="articleBody">
        <h2 id="background">Background</h2>

<div class="video" style="float: right; margin-left: 20px">
  <figure>
    <iframe src="//www.youtube.com/embed/ZIogd0kv80c" frameborder="0" allowfullscreen="" width="170" height="350"></iframe>
  </figure>
</div>

<p>Most iOS apps need to show external web content at some point. Apple provided multiple ways for a developer to do so, the official ones are:</p>

<h3 id="launch-a-url-in-safari">Launch a URL in Safari</h3>

<p>This will use the app switcher to move your own app into the background. This way, the user has their own browser (Safari), with their session and content blocker, browser plugins (e.g. 1Password), etc. As launching Safari puts your app into the background, many app developers are worried the user doesn’t come back to them.</p>

<p>Check out the first video to see how this looks in action ➡️</p>

<h3 id="use-in-app-sfsafariviewcontroller">Use in-app <a href="https://developer.apple.com/documentation/safariservices/sfsafariviewcontroller">SFSafariViewController</a></h3>

<p>Many third party iOS apps use this approach (e.g. Tweetbot).</p>
<div class="video" style="float: right; margin-left: 20px;">
  <figure>
    <iframe src="//www.youtube.com/embed/EPH5XGbigJU" frameborder="0" allowfullscreen="" width="170" height="350"></iframe>
  </figure>
</div>
<p>It allows an app developer to use the built-in Safari with all its features, without making the user leave your application. It features all the Safari features, but from within your application.</p>

<p>Check out the second video to see how this looks in action ➡️</p>

<h3 id="current-state-with-larger-social-network-apps">Current state with larger social network apps</h3>

<p>Many larger iOS apps re-implemented their own in-app web browser. While this was necessary many years ago, nowadays it’s not only not required any more, it actually adds a major risk to the end-user.</p>

<p>Those custom in-app browsers usually use their own UI elements:</p>

<ul>
  <li>Custom address bar</li>
  <li>Custom SSL indicator</li>
  <li>Custom share button</li>
  <li>Custom reload button</li>
</ul>

<p><img src="/assets/posts/browser/browser.png" width="250" style="float: right; margin-left: 30px" /></p>

<h2 id="problems-with-custom-in-app-browsers">Problems with custom in-app browsers</h2>

<p>If an app renders their own <a href="https://developer.apple.com/documentation/webkit/wkwebview">WKWebView</a>, they not only cause inconvenience for the user, but they actually put them at serious risk.</p>

<h3 id="convenience">Convenience</h3>

<h4 id="user-session">User session</h4>

<p>The user’s login session isn’t available, meaning if you get a link to e.g. an Amazon product, you now have to login and enter your 2-factor authentication code to purchase a product.</p>

<h4 id="browser-extensions">Browser extensions</h4>

<p>If the user has browser extensions (like password managers), they won’t have access to them in a custom in-app browser.</p>

<h4 id="deep-linking">Deep linking</h4>

<p>Deep linking itself has multiple open issues on the iOS platform. By using a custom in-app browser, it adds an extra layer that doesn’t work well with deep linking. Instead of opening the Amazon app when tapping on an Amazon link in “Social Media App X”, it opens the product in a plain web-view, with no login session, and no way to open the product in the app.</p>

<h4 id="content-blockers">Content blockers</h4>

<p>If the user has content blockers installed, they’re not being used by custom in-app browsers.</p>

<h4 id="bookmarks">Bookmarks</h4>

<p><img src="/assets/posts/browser/browser-dialog.png" width="250" style="float: right; margin-left: 30px" /></p>

<p>There is no way for the user to store the current URL in their bookmarks.</p>

<h4 id="share-a-website">Share a website</h4>

<p>Apps use this opportunity to force their users to use whatever “social features” they think are useful to them. Usually that means locking the user into their ecosystem, and not allowing people to share the content on the platform of their choice. There should be an explicit App Store rule against this.</p>

<h3 id="security--privacy">Security &amp; Privacy</h3>

<p>Using a custom in-app browser, allows the app developer to inject <strong>ANY</strong> JavaScript code into the website the user visits. This means, any content, any data and any input that is shown or stored on the website is accessible to the app.</p>

<h4 id="analytics">Analytics</h4>

<p>This is basically the main reason why in-app browsers are still a thing: It allows the app maintainer to inject additional analytics code, without telling the user. This way, the app’s developer can track the following:</p>

<ul>
  <li>How long does the user visit the linked website?</li>
  <li>How fast does the user scroll?</li>
  <li>Which links does the user open, and how long do they stay on each of them?</li>
  <li>Combined with <a href="https://krausefx.com/blog/ios-privacy-watchuser-access-both-iphone-cameras-any-time-your-app-is-running">watch.user</a>, the app can record you while you browse third party websites, or even use the iPhone X face sensor to parse your face</li>
  <li>Every single tap, swipe or any other gesture</li>
  <li>Device movements, GPS location (if granted) and any other granted iOS sensor, while the app is still in the foreground.</li>
</ul>

<h4 id="user-credentials">User credentials</h4>

<p>Any app with an in-app browser can easily steal the user’s email address, passwords and two-factor authentication codes. They can do that by injecting JavaScript code that bridges the data over to the app, or directly to a remote host. This is simple, it’s basically code like this:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">email</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"email"</span><span class="p">).</span><span class="nx">value</span>
<span class="nx">password</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"password"</span><span class="p">).</span><span class="nx">value</span>
</code></pre></div></div>

<p>That’s all that’s needed: just inject the code above to every website, run it on every user’s key stroke, and you’ll get a nice list of email addresses and passwords.</p>

<p>To run JavaScript in your own web view, you can just use</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">NSString</span> <span class="o">*</span><span class="n">script</span> <span class="o">=</span> <span class="err">@</span><span class="s2">"document.getElementById('password').value"</span><span class="p">;</span>

<span class="p">[</span><span class="nb">self</span> <span class="n">evaluateJavaScript</span><span class="ss">:script</span> <span class="n">completionHandler</span><span class="ss">:^</span><span class="p">(</span><span class="nb">id</span> <span class="n">result</span><span class="p">,</span> <span class="no">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}];</span>
</code></pre></div></div>

<h4 id="user-data">User data</h4>

<p>Once the user is logged in, you also get access to the full HTML DOM + JavaScript data &amp; events, which means you have full access to whatever the user sees. This includes things like your emails, your Amazon order history, your friend list, or whatever other data/website you access from an in-app web view.</p>

<h4 id="https">HTTPs</h4>

<p>Usually the web browser has a standardised way of indicating the SSL certificate next to the browser’s URL. In the case of custom in-app browsers, the SSL logo is being added by the app’s author, meaning you trust the app’s maintainer to only show the logo if it’s actually a valid SSL certificate.</p>

<h4 id="ads">Ads</h4>

<p>Custom in-app browsers allow all app developers to inject their own ad system into any website that’s shown as part of their app. But not only that, they can <strong>replace</strong> the ads identifier of ads that are already shown on the website, so that the revenue goes directly to them, instead of the website owner.</p>

<h4 id="and-more">And more</h4>

<p>These are just some of the things that immediately come to my mind, every time I use an in-app browser, there are probably a lot more evil things a company <a href="https://krausefx.com/blog/trusting-sdks">or SDK</a> could be doing.</p>

<h3 id="how-can-we-solve-this">How can we solve this?</h3>

<ul>
  <li>Reject apps that don’t use <a href="https://developer.apple.com/documentation/safariservices/sfsafariviewcontroller">SFSafariViewController</a> or launch Safari directly to show third party website content</li>
  <li>There should be exceptions, e.g. if a webview is used to show parts of the UI, or dynamic content, but it should be illegal to use webviews to show a linked or third party website</li>
</ul>

<p>I also <a href="https://openradar.appspot.com/radar?id=4963695432040448">filed a radar for this issue</a>.</p>

<h2 id="similar-projects-ive-worked-on">Similar projects I’ve worked on </h2>

<p>I published more posts on how to access the camera, the user’s location data, their Mac screen and their iCloud password, check out <a href="/privacy">krausefx.com/privacy</a> for more.</p>



        <!-- <p style="margin-top: 30px" class="side-projects-note">
  <small>Unless otherwise mentioned in the post, those projects are side projects which I work on on weekends and evenings, and are not affiliated with my work or employer.</small>
</p>
 -->
      </div>

      <p class="extra-info">
        
          Tags: security, privacy, sdks &nbsp; | &nbsp; 
        
        <a href="https://github.com/KrauseFx/krausefx.com/edit/master/_posts/2018-03-03-follow-user.md" target="_blank" class="forkButton">
  <svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
 
  Edit on GitHub
</a>
      </p>
    </article>
  
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline"><a href="/blog/trusting-sdks">Trusting third party SDKs</a></h1>
        <p class="post-meta">
          <time datetime="2018-02-15T00:00:00+00:00" itemprop="datePublished">
            
            Feb 15, 2018
          </time>
          </p>
      </header>

      <div class="post-content" itemprop="articleBody">
        <div class="video-box">
  <a href="https://www.youtube.com/watch?v=BXePggcWpuE">
    Prefer listening over reading? Check out a recording of this talk here
  </a>
</div>

<p>Third-party SDKs can often easily be <strong>modified</strong> while you download them! Using a simple <a href="https://wikipedia.org/wiki/Man_in_the_middle_attack">person-in-the-middle attack</a>, anyone in the same network can insert malicious code into the library, and with that into your application, as a result running in your user’s pockets.</p>

<p><strong>31%</strong> of the most popular closed-source iOS SDKs are vulnerable to this attack, as well as a total of <strong>623 libraries</strong> on CocoaPods. As part of this research I notified the affected parties, and submitted patches to CocoaPods to warn developers and SDK providers.</p>

<h2 id="what-are-the-potential-consequences-of-a-modified-sdk">What are the potential consequences of a modified SDK?</h2>

<p>It’s extremely dangerous if someone modifies an SDK before you install it. You are shipping your app with that code/binary. It will run on thousands or millions of devices within a few days, and everything you ship within your app runs with the <strong>exact</strong> same privileges as your app.</p>

<p>That means any SDK you include in your app has access to:</p>

<ul>
  <li>The same keychain your app has access to</li>
  <li>Any folders/files your app has access to</li>
  <li>Any app permissions your app has, e.g. location data, photo library access</li>
  <li>iCloud containers of your app</li>
  <li>All data your app exchanges with a web server, e.g. user logins, personal information</li>
</ul>

<p>Apple enforces iOS app sandboxing for good reasons, so don’t forget that <strong>any SDK you include in your app runs inside your app’s sandbox</strong>, and has access to everything your app has access to.</p>

<p>What’s the worst that a malicious SDK could do?</p>

<ul>
  <li>Steal sensitive user data, basically add a keylogger for your app, and record every tap</li>
  <li>Steal keys and user’s credentials</li>
  <li><a href="https://krausefx.com/blog/ios-privacy-detectlocation-an-easy-way-to-access-the-users-ios-location-data-without-actually-having-access">Access the user’s historic location data and sell it to third parties</a></li>
  <li><a href="https://krausefx.com/blog/ios-privacy-stealpassword-easily-get-the-users-apple-id-password-just-by-asking">Show phishing pop-ups for iCloud, or other login credentials</a></li>
  <li><a href="https://krausefx.com/blog/ios-privacy-watchuser-access-both-iphone-cameras-any-time-your-app-is-running">Take pictures in the background without telling the user</a></li>
</ul>

<p>The attack described here shows how an attacker can use <strong>your mobile app</strong> to steal sensitive user data.</p>

<h2 id="web-security-101">Web Security 101</h2>

<p>To understand how malicious code can be bundled into your app without your permission or awareness, I will provide necessary background to understanding how a <a href="https://wikipedia.org/wiki/Man_in_the_middle_attack">MITM attack</a> works and how to avoid it.</p>

<p>The information below is vastly simplified, as I try to describe things in a way that a mobile developer without too much network knowledge can get a sense of how things work and how they can protect themselves.</p>

<h3 id="https-vs-http">HTTPS vs HTTP</h3>

<p><strong>HTTP</strong>: Unencrypted traffic, anybody in the same network (WiFi or Ethernet) can easily listen to the packets. It’s very straightforward to do on unencrypted WiFi networks, but it’s actually almost as easy to do so on a protected WiFi or Ethernet network. There is no way for your computer to verify the packets came from the host you requested data from; Other computers can receive packets before you, open and modify them and send the modified version to you.</p>

<p><strong>HTTPS</strong>: With HTTPS traffic other hosts in the network can still listen to your packets, but can’t open them. They still get some basic metadata like the host name, but no details (like the body, full URL, …). Additionally your client also verifies that the packets came from the original host and that no one on the way there modified the content. HTTPS is based on TLS.</p>

<h3 id="how-a-browser-switches-from-http-to-https">How a browser switches from HTTP to HTTPS</h3>

<p>Enter “<a href="http://google.com">http://google.com</a>” in your web browser (make sure to use “http”, not “https”). You’ll see how the browser automatically switches from the unsafe “http” protocol to “https”.</p>

<p>This switch doesn’t happen in your browser but comes from the remote server (google.com), as your client (in this case the browser) can’t know what kind of protocol is supported by the host. (Exception for hosts that make use of <a href="https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security">HSTS</a>)</p>

<p><img src="/assets/posts/trusting-sdks/image_0.png" alt="" /></p>

<p>The initial request happens via “http”, so the server has no choice but to respond in clear text “http” to tell the client to switch over to the secure “https” protocol with a “301 Moved Permanently” response code.</p>

<p>You probably already see the problem here: since the response is being sent in clear text also, an attacker can modify that particular packet and replace the redirect destination URL to stay unencrypted “http”. This is called SSL Stripping, and we’ll talk more about this later.</p>

<h3 id="how-network-requests-work">How network requests work</h3>

<p>Very simplified, network requests work on multiple layers. Depending on the layer, different information is available on how to route a packet:</p>

<ul>
  <li>The lowest layer (Data Link Layer) uses MAC addresses to identify hosts in a network</li>
  <li>The layer above (Network Layer) uses IP addresses to identify hosts in the network</li>
  <li>The layers above add port information and the actual message content</li>
</ul>

<blockquote>
  <p>If you’re interested, you can learn how the OSI (Open Systems Interconnection) model works, in particular the implementation TCP/IP (e.g. <a href="http://microchipdeveloper.com/tcpip:tcp-ip-five-layer-model">http://microchipdeveloper.com/tcpip:tcp-ip-five-layer-model</a>).</p>
</blockquote>

<p>So, if your computer now sends a packet to the router, how does the router know where to route the packet based on the first layer (MAC addresses)? To solve this problem, the router uses a protocol called ARP (Address Resolution Protocol).</p>

<h3 id="how-arp-works-and-how-it-can-be-abused">How ARP works and how it can be abused</h3>

<p>Simplified, the devices in a network use ARP mapping to remember where to send packets of a certain MAC address. The way ARP works is simple: if a device wants to know where to send a packet for a certain IP address, it asks everyone in the network: “Which MAC address belongs to this IP?”. The device with that IP then replies to this message ✋</p>

<p style="text-align: center">
  <img src="/assets/posts/trusting-sdks/image_1.png" width="500" />
</p>

<p>Unfortunately, there is no way for a device to authenticate the sender of an ARP message. Therefore an attacker can be fast in responding to ARP announcements sent by another device, basically saying: “Hey, please send all packets that should go to IP address X to this MAC address”. The router will remember that and use that information for all future requests. This is called “ARP poisoning.”</p>

<p style="text-align: center">
  <img src="/assets/posts/trusting-sdks/image_2.png" width="650" />
</p>

<p>See how all packets are now routed through the attacker instead of going directly from the remote host to you?</p>

<p>As soon as the packets go through the attacker’s machine there is some risk. It’s the same risk you have when trusting your ISP or a VPN service: if the services you use are properly encrypted, they can’t really know details about what you’re doing or modify packets without your client (e.g. browser) noticing. As mentioned before there is still basic information that will always be visible such as certain metadata (e.g. the host name).</p>

<p>If there are web packets that are unencrypted (say HTTP) the attacker can not only look inside and read their content, but can also modify anything in there with no way of detecting the attack.</p>

<p><strong>Note</strong>: the technique described above is different from what you might have read about the security issues with public WiFi networks. Public WiFis are a problem because everybody can just read whatever packets are flying through the air, and if they’re unencrypted HTTP, it’s easy to read what’s happening. ARP pollution works on any network, no matter if public or not, or if WiFi or ethernet.</p>

<h2 id="lets-see-this-in-action">Let’s see this in action</h2>

<p>Let’s look into some SDKs and how they distribute their files, and see if we can find something.</p>

<h3 id="cocoapods">CocoaPods</h3>

<p><strong>Open source Pods</strong>: CocoaPods uses git under the hood to download code from code hosting services like GitHub. The <code class="highlighter-rouge">git://</code> protocol uses <code class="highlighter-rouge">ssh://</code>, which is similarly encrypted to HTTPS. In general, if you use CocoaPods to install open source SDKs from GitHub, you’re pretty safe.</p>

<p><strong>Closed source Pods</strong>: When preparing this blog post, I noticed that Pods can define a HTTP URL to reference binary SDKs, so I submitted multiple pull requests (<a href="https://github.com/CocoaPods/CocoaPods/pull/7249">1</a> and <a href="https://github.com/CocoaPods/CocoaPods/pull/7250">2</a>) that got merged and released with <a href="https://blog.cocoapods.org/CocoaPods-1.4.0/">CocoaPods 1.4.0</a> to show warnings when a Pod uses unencrypted http.</p>

<h3 id="crashlytics-sdk">Crashlytics SDK</h3>

<p>Crashlytics uses CocoaPods as the default distribution, but has 2 alternative installation methods: the Fabric Mac app and manual installation, which are both https encrypted, so not much we can do here.</p>

<h3 id="localytics"><a href="http://docs.localytics.com/dev/ios.html">Localytics</a></h3>

<p>Let’s look at a sample SDK, the docs page is unencrypted via http (see the address bar)</p>

<p><img src="/assets/posts/trusting-sdks/image_3.png" alt="" /></p>

<p>So you might think: “Ah, I’m just reading the docs here, I don’t care if it’s unencrypted”. The problem here is that the download link (in blue) is also transferred as part of the website, meaning an attacker can easily replace the <code class="highlighter-rouge">https://</code> link with <code class="highlighter-rouge">http://</code>, making the actual file download unsafe.</p>

<p>Alternatively an attacker could just switch the https:// link to the attacker’s URL that looks similar</p>

<ul>
  <li><a href="https://s3.amazonaws.com/localytics-sdk-docs/sdk.zip">https://s3.amazonaws.com/localytics-sdk/sdk.zip</a></li>
  <li><a href="https://s3.amazonaws.com/localytics-sdk-docs/sdk.zip">https://s3.amazonaws.com/localytics-sdk-binaries/sdk.zip</a></li>
</ul>

<p>And there is no good way for the user to verify that the specific host, URL or S3 bucket belongs to the author of the SDK.</p>

<p>To verify this I’ve set up my <a href="https://www.raspberrypi.org/">Raspberry PI</a> to intercept the traffic and do various SSL Stripping (downgrading of HTTPS connections to HTTP) across the board, from JavaScript files, to image resources and of course download links.</p>

<p><img src="/assets/posts/trusting-sdks/image_4.png" alt="" /></p>

<p>Once the download link was downgraded to HTTP, it’s easy to replace the content of the zip file as well:</p>

<p><img src="/assets/posts/trusting-sdks/image_5.png" alt="" /></p>

<p>Replacing HTML text on the fly is pretty easy, but how can an attacker replace the content of a zip file or binary?</p>

<ol>
  <li>The attacker downloads the original SDK</li>
  <li>The attacker inserts malicious code into the SDK</li>
  <li>The attacker compresses the modified SDK</li>
  <li>The attacker looks at packets coming by, and jumps in to replace any zip file matching a certain pattern with the file the attacker prepared</li>
</ol>

<p>(This is the same approach used by the <a href="https://charlesreid1.com/wiki/MITM_Labs/Bettercap_to_Replace_Images">image replacement trick</a>: Every image that’s transferred via HTTP gets replaced by a meme)</p>

<p>As a result, the downloaded SDK might include additional files or code that was modified:</p>

<p><img src="/assets/posts/trusting-sdks/image_6.png" alt="" /></p>

<p>For this attack to work, the requirements are:</p>

<ul>
  <li>The attacker is in the same network as you</li>
  <li>The docs page is unencrypted and allows SSL Stripping on all links</li>
</ul>

<p style="text-align: center">
  <img src="/assets/posts/trusting-sdks/image_7.png" width="600" />
</p>

<p>Localytics resolved the issue after disclosing it, so both the docs page, and the actual download are now HTTPS encrypted.</p>

<h3 id="askingpoint"><a href="https://www.askingpoint.com/documentation-ios-sdk/">AskingPoint</a></h3>

<p>Looking at the next SDK, we have a HTTPS encrypted docs page, looking at the screenshot, this looks secure:</p>

<p><img src="/assets/posts/trusting-sdks/image_8.png" alt="" /></p>

<p>Turns out, the HTTPS based website links to an unencrypted HTTP file, and web browsers don’t warn users in those cases (<a href="https://developers.google.com/web/fundamentals/security/prevent-mixed-content/what-is-mixed-content">some browsers already show a warning if JS/CSS files are downloaded via HTTP</a>). It’s almost impossible for the user to detect that something is going on here, except if they were to actually manually compare the hashes provided. As part of this project, I filed a security report for both Google Chrome (<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=794830">794830</a>) and Safari (<a href="https://openradar.appspot.com/radar?id=5000976083714048">rdar://36039748</a>) to warn the user of unencrypted file downloads on HTTPS sites.</p>

<h3 id="aws-sdk"><a href="https://aws.amazon.com/mobile/sdk/">AWS SDK</a></h3>

<p><img src="/assets/posts/trusting-sdks/image_9.png" alt="" /></p>

<p>At the time I was conducting this research, the AWS iOS SDK download page was HTTPS encrypted, however linked to a non-encrypted zip download, similarly to the SDKs mentioned before. The issue has been resolved after disclosing it to Amazon.</p>

<h2 id="putting-it-all-together">Putting it all together</h2>

<p>Thinking back about the iOS privacy vulnerabilities mentioned before (iCloud phishing, location access through pictures, accessing camera in background), what if we’re not talking about evil developers trying to trick their users… What if we talk about attackers that <strong>target you, the iOS developer</strong>, to reach millions of users within a short amount of time?</p>

<h3 id="attacking-the-developer">Attacking the developer</h3>

<p>What if an SDK gets modified as you download it using a person-in-the-middle attack, and inserts malicious code that breaks the user’s trust? Let’s take the iCloud phishing popup as an example, how hard would it be to use apps from other app developers to steal passwords from the user for you, and send them to your remote server?</p>

<p>In the video below you can see a sample iOS app that shows a mapview. After downloading and adding the AWS SDK to the project, you can see how malicious code is being executed, in this case an iCloud phishing popup is shown and the cleartext iCloud password can be accessed and sent to any remote server.</p>

<div class="video">
  <figure>
    <iframe width="100%" height="400" src="//www.youtube.com/embed/Mx2oFCyWg2A" frameborder="0" allowfullscreen=""></iframe>
  </figure>
</div>

<p>The only requirement for this particular attack to work is that the attacker is in the same network as you (e.g. stays in the same conference hotel). Alternatively this attack can also be done by your ISP or the VPN service you use. My Mac runs the default macOS configuration, meaning there is no proxy, custom DNS or VPN set up.</p>

<p>Setting up an attack like this is surprisingly easy using publicly available tools that are designed to do automatic SSL Stripping, ARP pollution and replacing of content of various requests. If you’ve done it before, it will take less than an hour to set everything up on any computer, including a Raspberry Pi, which I used for my research. The total costs for the whole attack is therefore less than $50.</p>

<p><img src="/assets/posts/trusting-sdks/image_10.jpg" width="420" /></p>

<p>I decided not to publish the names of all the tools I used, nor the code I wrote. You might want to look into well-known tools like <a href="https://moxie.org/software/sslstrip/">sslstrip</a>, <a href="https://mitmproxy.org/">mitmproxy</a> and <a href="https://www.wireshark.org/">Wireshark</a></p>

<h3 id="running-arbitrary-code-on-the-developers-machine">Running arbitrary code on the developer’s machine</h3>

<p>The previous example injected malicious code into the iOS app using a hijacked SDK. Another attack vector is the developer’s Mac. Once an attacker can run code on your machine, and maybe even has remote SSH access, the damage could be significant:</p>

<ul>
  <li>Activate remote SSH access for the admin account</li>
  <li>Install keylogger to get admin password</li>
  <li>Decrypt the keychain using the password, and send all credentials to remote server</li>
  <li>Access local secrets, like AWS credentials, CocoaPods &amp; RubyGems push tokens and more
    <ul>
      <li>If a developer now has a popular CocoaPod, you can spread more malicious code through their SDKs</li>
    </ul>
  </li>
  <li>Access literally any file and database on your Mac, including iMessage conversations, emails and source code</li>
  <li>Record the user’s screen without them knowing</li>
  <li>Install a new root SSL certificate, allowing the attacker to intercept most of your encrypted network requests</li>
</ul>

<p>To prove that this is working, I looked into how to inject malicious code in a shell script developers run locally, in this case BuddyBuild:</p>

<ul>
  <li>Same requirements as in the previous example, attacker needs to be in the same network</li>
  <li>BuddyBuild docs told users to <code class="highlighter-rouge">curl</code> an unencrypted URL piping the content over to <code class="highlighter-rouge">sh</code>, meaning any code the <code class="highlighter-rouge">curl</code> command returns will be executed</li>
  <li>The modified <code class="highlighter-rouge">UpdateSDK</code> is provided by the attacker (Raspberry PI), and asks for the admin password (normally BuddyBuild’s update script doesn’t ask for this)</li>
  <li>Within under a second, the malicious script does the following
    <ul>
      <li>Enable SSH remote access for the current account</li>
      <li>Install &amp; setup a keylogger that auto-starts when you login</li>
    </ul>
  </li>
</ul>

<p>Once the attacker has the root password and SSH access, they can do anything listed above.</p>

<div class="video">
  <figure>
    <iframe width="100%" height="400" src="//www.youtube.com/embed/N1Wj6ipc-HU" frameborder="0" allowfullscreen=""></iframe>
  </figure>
</div>

<p>BuddyBuild resolved the issue after reporting it.</p>

<h3 id="how-realistic-is-such-an-attack">How realistic is such an attack?</h3>

<p><strong>Very!</strong> Open your Network settings on the Mac, and take a look at the list of WiFi networks your Mac was connected to. In my case, my MacBook was connected to over 200 hotspots. How many of them can you fully trust? Even in a trustworthy network, there could still be other machines that got hacked previously which are doing remote controlled attacks (see section above)</p>

<p>SDKs and developer tools become more and more a target for attackers. Some examples from the past years:</p>

<ul>
  <li><a href="https://en.wikipedia.org/wiki/XcodeGhost">Xcode Ghost</a> affected about 4,000 iOS apps, including WeChat:
    <ul>
      <li>Attacker gains remote access to any phone running the app</li>
      <li>Show phishing popups</li>
      <li>Access and modify the clipboard (dangerous when using password managers)</li>
    </ul>
  </li>
  <li><a href="https://9to5mac.com/2017/03/07/cia-ios-malware-wikileaks/">The NSA worked on finding iOS exploits</a></li>
  <li><a href="https://www.kaspersky.com/blog/pegasus-spyware/14604/">Pegasus</a>: malware for non-jailbroken iPhones, <a href="https://citizenlab.ca/2016/08/million-dollar-dissident-iphone-zero-day-nso-group-uae/">used by governments</a></li>
  <li><a href="https://en.wikipedia.org/wiki/KeyRaider">KeyRaider</a>: Only affected jailbroken iPhones, but still stole user-credentials from over 200,000 end-users</li>
  <li>Just the last few weeks, there have been multiple posts about how this affects web projects also (e.g. <a href="https://hackernoon.com/im-harvesting-credit-card-numbers-and-passwords-from-your-site-here-s-how-9a8cb347c5b5">1</a>, <a href="https://scotthelme.co.uk/protect-site-from-cyrptojacking-csp-sri/">2</a>)</li>
</ul>

<p><a href="https://www.theiphonewiki.com/wiki/Malware_for_iOS">and many, many more</a>. Another approach is getting access to the download server (e.g. S3 bucket using access keys) and replacing the binary. This happened multiple times in the past few years, for example <a href="https://www.macrumors.com/2016/03/07/transmission-malware-downloaded-6500-times/">Transmission Mac app incident</a>. This opens a whole new level of area of attack, which I didn’t cover in this blog post.</p>

<h3 id="conferences-hotels-coffee-shops">Conferences, hotels, coffee shops</h3>

<p>Every time you connect to the WiFi at a conference, hotel or coffee shop, you become an easy target. Attackers know that there is a high number of developers during conferences and can easily make use of the situation.</p>

<h3 id="how-can-sdk-providers-protect-their-users">How can SDK providers protect their users?</h3>

<p>This would go out of scope for this blog post. Mozilla offers a <a href="https://developer.mozilla.org/en-US/docs/Web/Security">security guide</a> that’s a good starting point. Mozilla provides a tool called <a href="https://observatory.mozilla.org">observatory</a> that will do some automatic checks of the server settings and certificates.</p>

<h3 id="how-many-of-the-most-popular-sdks-are-affected-by-this-vulnerability">How many of the most popular SDKs are affected by this vulnerability?</h3>

<div style="float: right; width: 340px;">
  <img src="/assets/posts/trusting-sdks/image_11.png" width="100%" />
  <br />
  <br />
  <br />
  <img src="/assets/posts/trusting-sdks/image_12.png" width="100%" />
  <br />
  <br />
  <br />
  <img src="/assets/posts/trusting-sdks/image_13.png" width="100%" />
</div>

<p>While doing this research starting on 23rd November 2017, I investigated 41 of the most popular mobile SDKs according to <a href="https://www.appsight.io/?asot=2&amp;o=top&amp;os=ios">AppSight</a> (counting all Facebook and Google SDKs as one, as they share the same installation method - skipping SDKs that are open source on GitHub)</p>

<ul>
  <li><strong>41</strong> SDKs checked
    <ul>
      <li><strong>23</strong> are closed source and you can only download binary files</li>
      <li><strong>18</strong> of those are open source (all of them on GitHub)</li>
    </ul>
  </li>
  <li><strong>13</strong> are an easy target of person-in-the-middle attacks without any indication to the user
    <ul>
      <li><strong>10</strong> of them are closed source SDKs</li>
      <li><strong>3</strong> of them are open source SDKs, meaning the user can either download the SDK via unencrypted HTTP from the official website, or securely clone the source code from GitHub</li>
    </ul>
  </li>
  <li><strong>5</strong> of the 41 SDKs offer no way to download the SDK securely, meaning they don’t support any HTTPS at all, nor use a service that does (e.g. GitHub)</li>
  <li><strong>31%</strong> of the top used SDKs are easy targets for this attack</li>
  <li><strong>5</strong> additional SDKs required an account to download the SDK (do they have something to hide?)</li>
</ul>

<p>I notified all affected in November/December 2017, giving them 2 months to resolve the issue before publicly talking about it. Out of the 13 affected SDKs</p>

<ul>
  <li><strong>1</strong> resolved the issue within three business days</li>
  <li><strong>5</strong> resolved the issue within a month</li>
  <li><strong>7</strong> SDKs are still vulnerable to this attack at the time of publishing this post.</li>
</ul>

<p>The SDK providers that are still affected haven’t responded to my emails, or just replied with “We’re gonna look into this” - all of them in the top 50 most most-used SDKs.</p>

<p>Looking through the available CocoaPods, there are a total of <strong>4,800</strong> releases affected, from a total of <strong>623</strong> CocoaPods. I generated this data locally using the <code class="highlighter-rouge">Specs</code> repo with the command <code class="highlighter-rouge">grep -l -r '"http": "http://' *</code>.</p>

<h3 id="open-source-vs-closed-source">Open Source vs Closed Source</h3>

<p>Looking the number above, you are much likely to be affected by attacks if you use closed source SDKs. More importantly: When an SDK is closed source, it’s much harder for you to verify the integrity of the dependency. As you probably know, you should always <a href="https://guides.cocoapods.org/using/using-cocoapods.html#should-i-check-the-pods-directory-into-source-control">check the Pods directory into version control</a>, to detect changes and be able to audit your dependency updates. 100% of the open source SDKs I investigated can be used directly from GitHub, meaning even the 3 SDKs affected are not actually affected if you make sure to use the version on GitHub instead of taking it from the provider’s website.</p>

<p>Based on the numbers above it is clear that in addition to not being able to dive into the source code for closed source SDKs you also have a much higher risk of being attacked. Not only person-in-the-middle attacks, but also:</p>

<ul>
  <li>The attacker gains access to the SDK download server</li>
  <li>The company providing the SDK gets compromised</li>
  <li>The local government forces the company to include back-doors</li>
  <li>The company providing the SDK is evil and includes code &amp; tracking you don’t want</li>
</ul>

<p><strong>You are responsible for the binaries you ship!</strong> You have to make sure you don’t break your user’s trust, European Union data protection laws (<a href="https://www.eugdpr.org/">GDPR</a>) or steal the user’s credentials via a malicious SDK.</p>

<h2 id="wrapping-up">Wrapping up</h2>

<p>As a developer, it’s our responsibility to make sure we only ship code we trust. One of the easiest attack vectors right now is via malicious SDKs. If an SDK is open source, hosted on GitHub, and is installed via CocoaPods, you’re pretty safe. Be extra careful with bundling closed-source binaries or SDKs you don’t fully trust.</p>

<p>Since this type of attack can be done with little trace, you will not be able to easily find if your codebase is affected. By using open source code, we as developers can better protect ourselves, and with it, our customers.</p>

<p>Check out my <a href="/privacy">other privacy and security related publications</a>.</p>

<h2 id="update-crowdsourced-list-of-sdks">Update: Crowdsourced list of SDKs</h2>

<p>Many people asked for a list of affected SDKs. Instead of publishing a static list, I decided to setup a repo where every developer can add and update SDKs, check it out on <a href="https://github.com/trusting-sdks/https">trusting-sdks/https</a>.</p>

<h2 id="thank-you">Thank you</h2>

<p>Special thanks to <a href="https://twitter.com/acrooow">Manu Wallner</a> for doing the voice recordings for the video.</p>

<p>Special thanks to my friends for providing feedback on this post: <a href="https://twitter.com/jasdev">Jasdev Singh</a>, <a href="https://twitter.com/schukin">Dave Schukin</a>, <a href="https://twitter.com/acrooow">Manu Wallner</a>, <a href="https://twitter.com/domysee">Dominik Weber</a>, <a href="https://twitter.com/giladronat">Gilad</a>, <a href="http://haunold.me/">Nicolas Haunold</a> and Neel Rao.</p>

<div class="video-box">
  <a href="https://www.youtube.com/watch?v=BXePggcWpuE">
    Prefer listening over reading? Check out a recording of this talk here
  </a>
</div>



        <!-- <p style="margin-top: 30px" class="side-projects-note">
  <small>Unless otherwise mentioned in the post, those projects are side projects which I work on on weekends and evenings, and are not affiliated with my work or employer.</small>
</p>
 -->
      </div>

      <p class="extra-info">
        
          Tags: security, privacy, sdks &nbsp; | &nbsp; 
        
        <a href="https://github.com/KrauseFx/krausefx.com/edit/master/_posts/2018-02-15-trusting-sdks.md" target="_blank" class="forkButton">
  <svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
 
  Edit on GitHub
</a>
      </p>
    </article>
  
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline"><a href="/blog/mac-privacy-sandboxed-mac-apps-can-take-screenshots">Mac Privacy: Sandboxed Mac apps can record your screen at any time without you knowing</a></h1>
        <p class="post-meta">
          <time datetime="2018-02-10T00:00:00+00:00" itemprop="datePublished">
            
            Feb 10, 2018
          </time>
          </p>
      </header>

      <div class="post-content" itemprop="articleBody">
        <p><strong>Update 2019-06-04</strong> Looks like Apple has fixed this issue with macOS Catalina</p>

<h2 id="facts">Facts</h2>

<p>Any Mac app, sandboxed or not sandboxed can:</p>

<ul>
  <li>Take screenshots of your Mac silently without you knowing</li>
  <li>Access every pixel, even if the Mac app is in the background</li>
  <li>Use basic <a href="https://en.wikipedia.org/wiki/Optical_character_recognition">OCR software</a> to read the text on the screen</li>
  <li>Access all connected monitors</li>
</ul>

<h2 id="whats-the-worst-that-could-happen">What’s the worst that could happen?</h2>

<ul>
  <li>Read password and keys from password managers</li>
  <li>Detect what web services you use (e.g. email provider)</li>
  <li>Read all emails and messages you open on your Mac</li>
  <li>When a developer is targeted, this allows the attacker to potentially access sensitive source code, API keys or similar data</li>
  <li>Learn personal information about the user, like their bank details, salary, address, etc.</li>
</ul>

<p><a href="/assets/posts/mac-take-screenshots.png" target="_blank">
  <img src="/assets/posts/mac-take-screenshots.png" />
</a></p>

<h2 id="disclaimer">Disclaimer</h2>

<p>This project is a proof of concept and should not be used in production. The goal is to highlight a privacy loophole that can be abused by Mac apps.</p>

<h2 id="how-can-i-protect-myself-as-a-user">How can I protect myself as a user?</h2>

<p>To my knowledge there is no way to protect yourself as of now.</p>

<h2 id="proposal">Proposal</h2>

<p>There are lots of valid use-cases for Mac apps to record the screen, e.g. <a href="https://support.1password.com/one-time-passwords/">1Password 2fA support</a>, screen recording software or even simple screen sharing via your web browser or Skype. However there must be some kind of control:</p>

<ul>
  <li>The App Store review process could verify the Sandbox entitlements for accessing the screen</li>
  <li>Put the user in charge with a permission dialog</li>
  <li>Additionally the user should be notified whenever an app accesses the screen.</li>
</ul>

<p>Of course, I also <a href="https://openradar.appspot.com/radar?id=5610698700750848">filed a radar</a> (rdar://37423927) to notify Apple about this issue.</p>

<h2 id="how-does-it-work">How does it work?</h2>

<p>A developer just needs to use <code class="highlighter-rouge">CGWindowListCreateImage</code> to generate a capture of the complete screen within an instant:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">CGImageRef</span> <span class="n">screenshot</span> <span class="o">=</span> <span class="no">CGWindowListCreateImage</span><span class="p">(</span>
  <span class="no">CGRectInfinite</span><span class="p">,</span> 
  <span class="n">kCGWindowListOptionOnScreenOnly</span><span class="p">,</span> 
  <span class="n">kCGNullWindowID</span><span class="p">,</span> 
  <span class="n">kCGWindowImageDefault</span><span class="p">);</span>

<span class="no">NSBitmapImageRep</span> <span class="o">*</span><span class="n">bitmapRep</span> <span class="o">=</span> <span class="p">[[</span><span class="no">NSBitmapImageRep</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">initWithCGImage</span><span class="ss">:screenshot</span><span class="p">];</span>
</code></pre></div></div>

<p>In my experiments, I piped the generated image over to a <a href="https://en.wikipedia.org/wiki/Optical_character_recognition">OCR library</a> and was able to get all text that was rendered on the user’s machine.</p>

<p><strong>Update 2019-06-04</strong> Looks like Apple has fixed this issue with macOS Catalina</p>

<h2 id="similar-projects-ive-worked-on">Similar projects I’ve worked on </h2>

<p>I published more posts on how to access the camera, the user’s location data, their Mac screen and their iCloud password, check out <a href="/privacy">krausefx.com/privacy</a> for more.</p>


        <!-- <p style="margin-top: 30px" class="side-projects-note">
  <small>Unless otherwise mentioned in the post, those projects are side projects which I work on on weekends and evenings, and are not affiliated with my work or employer.</small>
</p>
 -->
      </div>

      <p class="extra-info">
        
          Tags: mac, screenshot, privacy &nbsp; | &nbsp; 
        
        <a href="https://github.com/KrauseFx/krausefx.com/edit/master/_posts/2018-02-10-mac-privacy-sandboxed-mac-apps-can-take-screenshots.md" target="_blank" class="forkButton">
  <svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
 
  Edit on GitHub
</a>
      </p>
    </article>
  

  <!-- Pagination links -->
  <div class="pagination">
    
      <a href="/blog/page2/" class="previous">Newer</a>
    
    /
    
      <a href="/blog/page4/" class="next">Older</a>
    
  </div>

</div>

      </div>
    </main>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          <li>
            <a href="https://github.com/KrauseFx" target="_blank"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">KrauseFx</span></a>

          </li>
          <li>
            <a href="https://twitter.com/KrauseFx" target="_blank"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">KrauseFx</span></a>

          </li>
        </ul>
      </div>
      <div class="footer-col footer-col-2"></div>
      <div class="footer-col footer-col-3">
        <p class="subscribe-newsletter">
  Want to be the first to hear about more privacy and mobile related essays?
</p>

<form class="subscribe-form" action="https://krausefx.us10.list-manage.com/subscribe/post?u=a84ca3495977afb89bf2b98fb&amp;id=d9610c8987" method="post" target="popupwindow" onsubmit="window.open('https://krausefx.us10.list-manage.com/subscribe/post?u=a84ca3495977afb89bf2b98fb', 'popupwindow', 'scrollbars=yes,width=600,height=620');return true">
  <label for="tlemail"></label>
  <input type="text" placeholder="Email Address" name="EMAIL" id="tlemail">
  <input type="hidden" value="1" name="embed">
  <button type="submit" name="subscribe">
    Subscribe
  </button>
</form>

      </div>
    </div>

  </div>
</footer>

<script type="text/javascript">
  var links = document.links;
  for (var i = 0, linksLength = links.length; i < linksLength; i++) {
    if (links[i].hostname != window.location.hostname) {
      links[i].target = '_blank';
    } 
  }
</script>


  </body>

</html>
